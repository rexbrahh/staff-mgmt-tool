(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{2408:(e,a,r)=>{Promise.resolve().then(r.bind(r,9690))},7335:(e,a,r)=>{"use strict";r.d(a,{GV:()=>l,jL:()=>s});var t=r(4540);let s=()=>(0,t.wA)(),l=t.d4},8284:(e,a,r)=>{"use strict";r.d(a,{ET:()=>g,Ay:()=>k,iD:()=>d,ri:()=>m});var t=r(1990),s=r(3464);let l="http://localhost:5001/api";class n{async login(e){let a=(await s.A.post("".concat(l,"/auth/login"),e)).data;return a.token&&this.setToken(a.token),a}async register(e){let a=(await s.A.post("".concat(l,"/auth/register"),e)).data;return a.token&&this.setToken(a.token),a}async getProfile(){return(await s.A.get("".concat(l,"/auth/profile"),{headers:this.getAuthHeaders()})).data}logout(){this.token=null,localStorage.removeItem("token")}getCurrentToken(){return this.token}isAuthenticated(){return!!this.token}setToken(e){this.token=e,localStorage.setItem("token",e)}getAuthHeaders(){return{Authorization:"Bearer ".concat(this.token)}}setupInterceptors(){s.A.interceptors.request.use(e=>(this.token&&(e.headers.Authorization="Bearer ".concat(this.token)),e),e=>Promise.reject(e)),s.A.interceptors.response.use(e=>e,e=>{var a;return(null==(a=e.response)?void 0:a.status)===401&&(this.logout(),window.location.href="/login"),Promise.reject(e)})}constructor(){this.token=null,this.token=localStorage.getItem("token"),this.setupInterceptors()}}let o=new n,i={user:null,token:o.getCurrentToken(),isAuthenticated:o.isAuthenticated(),loading:!1,error:null},d=(0,t.zD)("auth/login",async(e,a)=>{let{rejectWithValue:r}=a;try{return await o.login(e)}catch(e){var t,s;return r((null==(s=e.response)||null==(t=s.data)?void 0:t.message)||"Login failed")}}),u=(0,t.zD)("auth/register",async(e,a)=>{let{rejectWithValue:r}=a;try{return await o.register(e)}catch(e){var t,s;return r((null==(s=e.response)||null==(t=s.data)?void 0:t.message)||"Registration failed")}}),c=(0,t.zD)("auth/getProfile",async(e,a)=>{let{rejectWithValue:r}=a;try{return await o.getProfile()}catch(e){var t,s;return r((null==(s=e.response)||null==(t=s.data)?void 0:t.message)||"Failed to load profile")}}),h=(0,t.Z0)({name:"auth",initialState:i,reducers:{logout:e=>{o.logout(),e.user=null,e.token=null,e.isAuthenticated=!1,e.error=null},clearError:e=>{e.error=null},setCredentials:(e,a)=>{e.user=a.payload.user,e.token=a.payload.token,e.isAuthenticated=!0}},extraReducers:e=>{e.addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,(e,a)=>{e.loading=!1,e.isAuthenticated=!0,e.user=a.payload.user,e.token=a.payload.token,e.error=null}).addCase(d.rejected,(e,a)=>{e.loading=!1,e.error=a.payload,e.isAuthenticated=!1,e.user=null,e.token=null}).addCase(u.pending,e=>{e.loading=!0,e.error=null}).addCase(u.fulfilled,(e,a)=>{e.loading=!1,e.isAuthenticated=!0,e.user=a.payload.user,e.token=a.payload.token,e.error=null}).addCase(u.rejected,(e,a)=>{e.loading=!1,e.error=a.payload,e.isAuthenticated=!1,e.user=null,e.token=null}).addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,(e,a)=>{e.loading=!1,e.user=a.payload,e.error=null}).addCase(c.rejected,(e,a)=>{e.loading=!1,e.error=a.payload})}}),{logout:m,clearError:g,setCredentials:p}=h.actions,k=h.reducer},9690:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>b});var t=r(5155),s=r(2115),l=r(5695),n=r(9694),o=r(7129),i=r(785),d=r(1218),u=r(6632),c=r(1116),h=r(8164),m=r(5999),g=r(8534),p=r(4426),k=r(4581),A=r(6874),f=r.n(A),y=r(7335),v=r(8284);let w=o.Ik({email:o.Yj().email("Enter a valid email").required("Email is required"),password:o.Yj().min(6,"Password must be at least 6 characters").required("Password is required")});function b(){let e=(0,y.jL)(),a=(0,l.useRouter)(),{loading:r,error:o,isAuthenticated:A}=(0,y.GV)(e=>e.auth),[b,j]=(0,s.useState)(!1),x=(0,n.Wx)({initialValues:{email:"",password:""},validationSchema:w,onSubmit:async r=>{e((0,v.ET)());let t=await e((0,v.iD)(r));v.iD.fulfilled.match(t)?a.push("/dashboard"):j(!0)}});return(0,s.useEffect)(()=>{A&&a.push("/dashboard")},[A,a]),(0,s.useEffect)(()=>{o&&j(!0)},[o]),(0,t.jsx)(i.A,{maxWidth:"sm",className:"py-8",children:(0,t.jsx)(d.A,{children:(0,t.jsxs)(u.A,{className:"p-8",children:[(0,t.jsx)(c.A,{variant:"h4",component:"h1",className:"text-center mb-6",children:"Login"}),b&&o&&(0,t.jsx)(h.A,{severity:"error",className:"mb-4",onClose:()=>{j(!1),e((0,v.ET)())},children:o}),(0,t.jsxs)("form",{onSubmit:x.handleSubmit,children:[(0,t.jsx)(m.A,{fullWidth:!0,id:"email",name:"email",label:"Email",value:x.values.email,onChange:x.handleChange,onBlur:x.handleBlur,error:x.touched.email&&!!x.errors.email,helperText:x.touched.email&&x.errors.email,className:"mb-4",margin:"normal"}),(0,t.jsx)(m.A,{fullWidth:!0,id:"password",name:"password",label:"Password",type:"password",value:x.values.password,onChange:x.handleChange,onBlur:x.handleBlur,error:x.touched.password&&!!x.errors.password,helperText:x.touched.password&&x.errors.password,className:"mb-6",margin:"normal"}),(0,t.jsx)(g.A,{color:"primary",variant:"contained",fullWidth:!0,type:"submit",size:"large",disabled:r,className:"mb-4",children:r?(0,t.jsx)(p.A,{size:24}):"Login"})]}),(0,t.jsx)(k.A,{className:"text-center",children:(0,t.jsxs)(c.A,{variant:"body2",children:["Don't have an account?"," ",(0,t.jsx)(f(),{href:"/register",className:"text-blue-600 hover:underline",children:"Register here"})]})}),(0,t.jsxs)(k.A,{className:"mt-6 p-4 bg-gray-100 rounded",children:[(0,t.jsx)(c.A,{variant:"body2",className:"font-semibold mb-2",children:"Demo Admin Credentials:"}),(0,t.jsxs)(c.A,{variant:"body2",className:"text-gray-600",children:["Email: admin@staffmanagement.com",(0,t.jsx)("br",{}),"Password: admin123456"]})]})]})})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[461,585,605,874,948,113,441,684,358],()=>a(2408)),_N_E=e.O()}]);