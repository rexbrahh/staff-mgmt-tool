(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{2408:(e,t,a)=>{Promise.resolve().then(a.bind(a,9690))},7335:(e,t,a)=>{"use strict";a.d(t,{G:()=>o,j:()=>l});var r=a(4540);let l=()=>(0,r.wA)(),o=r.d4},8284:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>m,Lx:()=>n,ri:()=>c});var r=a(1990),l=a(3464);let o="http://localhost:5001/api",s=l.A.create({baseURL:o,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let i={async login(e){console.log("AuthService: Making login request to:",o+"/auth/login"),console.log("AuthService: Credentials:",e);try{let t=await s.post("/auth/login",e);return console.log("AuthService: Login response:",t.data),t.data.token&&(localStorage.setItem("token",t.data.token),console.log("AuthService: Token saved to localStorage")),t.data}catch(e){throw console.error("AuthService: Login error:",e),e}},async register(e){let t=await s.post("/auth/register",e);return t.data.token&&localStorage.setItem("token",t.data.token),t.data},getProfile:async()=>(await s.get("/auth/profile")).data,logout(){localStorage.removeItem("token")},getToken:()=>localStorage.getItem("token")},n=(0,r.zD)("auth/login",async e=>await i.login(e)),d=(0,r.zD)("auth/register",async e=>await i.register(e)),u=(0,r.Z0)({name:"auth",initialState:{user:null,token:null,isAuthenticated:!1,loading:!1,error:null},reducers:{logout:e=>{e.user=null,e.token=null,e.isAuthenticated=!1,e.error=null,i.logout()},clearError:e=>{e.error=null},setCredentials:(e,t)=>{e.user=t.payload.user,e.token=t.payload.token,e.isAuthenticated=!0,e.error=null}},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.loading=!1,e.user=t.payload.user,e.token=t.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message||"Login failed"}).addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,(e,t)=>{e.loading=!1,e.user=t.payload.user,e.token=t.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(d.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message||"Registration failed"})}}),{logout:c,clearError:g,setCredentials:h}=u.actions,m=u.reducer},9690:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var r=a(5155),l=a(2115),o=a(5695),s=a(7217),i=a(8407),n=a(1116),d=a(8164),u=a(4581),c=a(2421),g=a(8534),h=a(9694),m=a(7129),p=a(7335),k=a(8284);let A=m.Ik({email:m.Yj().email("Invalid email address").required("Email is required"),password:m.Yj().min(6,"Password must be at least 6 characters").required("Password is required")});function x(){let e=(0,p.j)(),t=(0,o.useRouter)(),[a,m]=(0,l.useState)(""),x=async a=>{try{m(""),console.log("Attempting login with:",a);let r=await e((0,k.Lx)(a));console.log("Login result:",r),"fulfilled"===r.meta.requestStatus?(console.log("Login successful, redirecting to dashboard"),t.push("/dashboard")):(console.log("Login failed:",r),m("Invalid credentials"))}catch(e){console.error("Login error:",e),m("Login failed. Please try again.")}};return(0,r.jsx)(s.A,{maxWidth:"sm",sx:{mt:8},children:(0,r.jsxs)(i.A,{elevation:3,sx:{p:4},children:[(0,r.jsx)(n.A,{variant:"h4",component:"h1",textAlign:"center",gutterBottom:!0,children:"Login"}),a&&(0,r.jsx)(d.A,{severity:"error",sx:{mb:2},children:a}),(0,r.jsx)(h.l1,{initialValues:{email:"",password:""},validationSchema:A,onSubmit:x,children:e=>{let{errors:t,touched:a,isSubmitting:l}=e;return(0,r.jsxs)(h.lV,{children:[(0,r.jsx)(u.A,{sx:{mb:2},children:(0,r.jsx)(h.D0,{as:c.A,name:"email",label:"Email",type:"email",fullWidth:!0,error:a.email&&t.email,helperText:a.email&&t.email})}),(0,r.jsx)(u.A,{sx:{mb:3},children:(0,r.jsx)(h.D0,{as:c.A,name:"password",label:"Password",type:"password",fullWidth:!0,error:a.password&&t.password,helperText:a.password&&t.password})}),(0,r.jsx)(g.A,{type:"submit",variant:"contained",fullWidth:!0,size:"large",disabled:l,children:l?"Logging in...":"Login"})]})}})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[461,585,521,883,441,684,358],()=>t(2408)),_N_E=e.O()}]);