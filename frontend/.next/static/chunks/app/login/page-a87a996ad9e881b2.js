(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{1457:(e,o,t)=>{"use strict";t.d(o,{y:()=>n});var l=t(3464);let a="http://localhost:5001/api",r=l.A.create({baseURL:a,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{let o=localStorage.getItem("token");return o&&(e.headers.Authorization="Bearer ".concat(o)),e});let n={async login(e){console.log("\uD83C\uDF10 AuthService: Making API call to:","".concat(a,"/auth/login")),console.log("\uD83D\uDCE7 AuthService: Sending credentials:",{email:e.email,password:"***"});try{let o=await r.post("/auth/login",e);return console.log("\uD83D\uDCE1 AuthService: API response received:",o.data),console.log("✅ AuthService: Response status:",o.status),o.data.token&&(localStorage.setItem("token",o.data.token),console.log("\uD83D\uDCBE AuthService: Token saved to localStorage"),document.cookie="token=".concat(o.data.token,"; path=/; max-age=").concat(86400),console.log("\uD83C\uDF6A AuthService: Token saved to cookies")),o.data}catch(r){var o,t,l,n,s;console.error("\uD83D\uDEA8 AuthService: API call failed:",r),console.error("\uD83D\uDCC4 Error response data:",null==(o=r.response)?void 0:o.data),console.error("\uD83D\uDD22 Error status:",null==(t=r.response)?void 0:t.status),console.error("\uD83D\uDD17 Error config:",r.config),console.error("\uD83D\uDCA5 Full error object:",r);let e=(null==(n=r.response)||null==(l=n.data)?void 0:l.message)||r.message||"Login failed",a=(null==(s=r.response)?void 0:s.status)||"Unknown";throw console.error("\uD83C\uDFAF Throwing error with message:",e,"status:",a),Error("".concat(e," (Status: ").concat(a,")"))}},async register(e){let o=await r.post("/auth/register",e);return o.data.token&&(localStorage.setItem("token",o.data.token),document.cookie="token=".concat(o.data.token,"; path=/; max-age=").concat(86400)),o.data},getProfile:async()=>(await r.get("/auth/profile")).data,logout(){localStorage.removeItem("token"),document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},getToken:()=>localStorage.getItem("token")}},2408:(e,o,t)=>{Promise.resolve().then(t.bind(t,9690))},7335:(e,o,t)=>{"use strict";t.d(o,{G:()=>r,j:()=>a});var l=t(4540);let a=()=>(0,l.wA)(),r=l.d4},7574:(e,o,t)=>{"use strict";t.d(o,{Ay:()=>h,Lx:()=>r,Nu:()=>g,l2:()=>s,ri:()=>d});var l=t(1990),a=t(1457);let r=(0,l.zD)("auth/login",async e=>await a.y.login(e)),n=(0,l.zD)("auth/register",async e=>await a.y.register(e)),s=(0,l.zD)("auth/fetchProfile",async()=>await a.y.getProfile()),i=(0,l.Z0)({name:"auth",initialState:{user:null,token:null,isAuthenticated:!1,loading:!1,error:null},reducers:{logout:e=>{e.user=null,e.token=null,e.isAuthenticated=!1,e.error=null,a.y.logout()},clearError:e=>{e.error=null},setCredentials:(e,o)=>{e.user=o.payload.user,e.token=o.payload.token,e.isAuthenticated=!0,e.error=null},initializeAuth:(e,o)=>{console.log("\uD83D\uDD27 Redux: initializeAuth called with token:",o.payload.token?"YES":"NO"),o.payload.token?(e.token=o.payload.token,e.isAuthenticated=!0,console.log("✅ Redux: Auth initialized with token")):console.log("❌ Redux: No token found, user not authenticated")}},extraReducers:e=>{e.addCase(r.pending,e=>{e.loading=!0,e.error=null}).addCase(r.fulfilled,(e,o)=>{console.log("\uD83D\uDD04 Redux: loginUser.fulfilled action received:",o.payload),e.loading=!1,e.user=o.payload.user,e.token=o.payload.token,e.isAuthenticated=!0,e.error=null,console.log("✅ Redux: Auth state updated - isAuthenticated:",!0)}).addCase(r.rejected,(e,o)=>{e.loading=!1,e.error=o.error.message||"Login failed"}).addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,o)=>{e.loading=!1,e.user=o.payload.user,e.token=o.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(n.rejected,(e,o)=>{e.loading=!1,e.error=o.error.message||"Registration failed"}).addCase(s.fulfilled,(e,o)=>{console.log("\uD83D\uDC64 Redux: fetchUserProfile.fulfilled, user data:",o.payload),e.user=o.payload.user,e.isAuthenticated=!0}).addCase(s.rejected,e=>{e.user=null,e.token=null,e.isAuthenticated=!1,a.y.logout()})}}),{logout:d,clearError:c,setCredentials:u,initializeAuth:g}=i.actions,h=i.reducer},9690:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>f});var l=t(5155),a=t(2115),r=t(5695),n=t(7217),s=t(8407),i=t(1116),d=t(4581),c=t(2302),u=t(8449),g=t(8534),h=t(9694),p=t(7129),m=t(7335),y=t(7574);let k=p.Ik({email:p.Yj().email("Invalid email address").required("Email is required"),password:p.Yj().min(6,"Password must be at least 6 characters").required("Password is required")});function f(){console.log("\uD83C\uDFAC LoginPage: Component function called");let e=(0,m.j)(),o=(0,r.useRouter)(),[t,p]=(0,a.useState)(""),{isAuthenticated:f,user:x,loading:A}=(0,m.G)(e=>e.auth);console.log("\uD83C\uDFE0 LoginPage: Component rendered/re-rendered"),console.log("\uD83C\uDFE0 LoginPage: Current auth state:",{isAuthenticated:f,user:null==x?void 0:x.email,loading:A}),console.log("\uD83C\uDFE0 LoginPage: Dependencies loaded successfully"),console.log("\uD83C\uDFE0 LoginPage: dispatch type:",typeof e),console.log("\uD83C\uDFE0 LoginPage: router type:",typeof o);let v=e=>{console.log("\uD83D\uDDB1️ BUTTON CLICKED!",e),console.log("\uD83D\uDDB1️ Button event type:",e.type),console.log("\uD83D\uDDB1️ Button target:",e.target)},w=async t=>{console.log("\uD83C\uDFAF handleSubmit CALLED!!! Values:",t),console.log("\uD83C\uDFAF handleSubmit function type:",typeof w);try{var l,a;console.log("\uD83D\uDE80 Login attempt started"),p(""),console.log("\uD83D\uDCE7 Credentials:",{email:t.email,password:"***"});let r=await e((0,y.Lx)(t));if(console.log("\uD83D\uDCEC Redux dispatch result:",r),console.log("\uD83D\uDCCA Result meta:",r.meta),console.log("\uD83D\uDD0D Request status:",null==(l=r.meta)?void 0:l.requestStatus),"fulfilled"===r.meta.requestStatus)console.log("✅ Login fulfilled, payload:",r.payload),console.log("\uD83D\uDD00 Redirecting to dashboard..."),setTimeout(()=>{o.push("/dashboard")},100);else if("rejected"===r.meta.requestStatus){console.log("❌ Login rejected:",r),console.log("❌ Rejection payload:",r.payload),console.log("❌ Rejection error:",r.error);let e=(null==(a=r.error)?void 0:a.message)||"Invalid credentials. Please check your email and password.";p(e)}else console.log("❓ Unknown login result:",r),p("Login failed. Please try again.")}catch(e){console.error("\uD83D\uDCA5 Login error in catch:",e),p("Login failed. Please try again.")}};return(0,l.jsx)(n.A,{maxWidth:"sm",sx:{mt:8},children:(0,l.jsxs)(s.A,{elevation:3,sx:{p:4},children:[(0,l.jsx)(i.A,{variant:"h4",component:"h1",textAlign:"center",gutterBottom:!0,children:"Login"}),(0,l.jsx)(d.A,{sx:{mb:2,p:2,bgcolor:"info.light",borderRadius:1},children:(0,l.jsxs)(i.A,{variant:"body2",color:"info.contrastText",children:[(0,l.jsx)("strong",{children:"Test Credentials:"}),(0,l.jsx)("br",{}),"Email: test@example.com",(0,l.jsx)("br",{}),"Password: password123"]})}),t&&(0,l.jsx)(c.A,{severity:"error",sx:{mb:2},children:t}),(0,l.jsx)(h.l1,{initialValues:{email:"test@example.com",password:"password123"},validationSchema:k,onSubmit:(e,o)=>(console.log("\uD83D\uDCDD Formik onSubmit triggered!",e),console.log("\uD83D\uDCDD Formik bag:",o),w(e)),children:e=>{let{errors:o,touched:t,isSubmitting:a,handleSubmit:r}=e;return console.log("\uD83D\uDCCB Formik render function called"),console.log("\uD83D\uDCCB isSubmitting:",a),console.log("\uD83D\uDCCB errors:",o),console.log("\uD83D\uDCCB formikHandleSubmit type:",typeof r),(0,l.jsxs)(h.lV,{onSubmit:e=>{console.log("\uD83D\uDD25 FORM onSubmit triggered!",e),console.log("\uD83D\uDD25 Event target:",e.target),console.log("\uD83D\uDD25 Event type:",e.type),r(e)},children:[(0,l.jsx)(d.A,{sx:{mb:2},children:(0,l.jsx)(h.D0,{as:u.A,name:"email",label:"Email",type:"email",fullWidth:!0,error:t.email&&o.email,helperText:t.email&&o.email})}),(0,l.jsx)(d.A,{sx:{mb:3},children:(0,l.jsx)(h.D0,{as:u.A,name:"password",label:"Password",type:"password",fullWidth:!0,error:t.password&&o.password,helperText:t.password&&o.password})}),(0,l.jsx)(g.A,{type:"submit",variant:"contained",fullWidth:!0,size:"large",disabled:a,onClick:e=>{console.log("\uD83D\uDD34 BUTTON CLICKED!!!",e),console.log("\uD83D\uDD34 Button disabled?",a),console.log("\uD83D\uDD34 Button type:",e.currentTarget.type),v(e)},children:a?"Logging in...":"Login"})]})}})]})})}}},e=>{var o=o=>e(e.s=o);e.O(0,[416,903,464,540,990,921,449,146,441,684,358],()=>o(2408)),_N_E=e.O()}]);